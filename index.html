<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Tutto Karten</title>
<link rel="manifest" href="manifest.json" />
<meta name="theme-color" content="#6b4e4e" />
<style>
  @import url('https://fonts.googleapis.com/css2?family=Comic+Neue:wght@700&family=Roboto+Slab&family=Press+Start+2P&display=swap');

  body, html {
    margin:0; padding:0; height:100%;
    font-family: 'Roboto Slab', serif;
    display:flex; flex-direction: column; align-items: center; justify-content: center;
    user-select:none;
    transition: background 1.5s ease;
    background-color: #faf8f6;
  }

  #game { text-align: center; user-select:none; z-index: 1; }

  .background-layer {
    position: fixed; top:0; left:0; width:100%; height:100%;
    z-index: 0; pointer-events: none;
    transition: background 1.5s ease;
  }

  /* Sanftere Hintergrunddesigns */
  .design-0-bg { background: linear-gradient(135deg, #fdf3f3 0%, #f8e6e6 100%); }
  .design-1-bg {
    background-color: #f7faff;
    background-image: linear-gradient(#d0dff5 1px, transparent 1px),
                      linear-gradient(to right, #d0dff5 1px, transparent 1px);
    background-size: 20px 20px;
  }
  .design-2-bg {
    background-color: #2b2b2b;
    background-image: linear-gradient(45deg, #3a3a3a 25%, transparent 25%),
                      linear-gradient(-45deg, #3a3a3a 25%, transparent 25%),
                      linear-gradient(45deg, transparent 75%, #3a3a3a 75%),
                      linear-gradient(-45deg, transparent 75%, #3a3a3a 75%);
    background-size: 40px 40px;
  }
  .design-3-bg {
    background-color: #f5f7fa;
    background-image: radial-gradient(#d6eaf8 5%, transparent 5%);
    background-size: 40px 40px;
  }

  .card {
    width: 160px; height: 240px;
    border-radius: 16px;
    box-shadow: 0 8px 20px rgba(0,0,0,0.2);
    position: relative;
    margin: 20px auto;
    cursor: pointer;
    perspective: 1000px;
  }
  .inner-card {
    width: 100%; height: 100%;
    background: white;
    border-radius: 16px;
    position: relative;
    transform-style: preserve-3d;
    transition: transform 0.8s cubic-bezier(0.4,0,0.2,1);
    box-shadow: inset 0 0 40px rgba(0,0,0,0.05);
    transform: rotateY(0deg);
  }
  .inner-card.flipped { transform: rotateY(180deg); }
  .face {
    position: absolute;
    width: 100%; height: 100%;
    backface-visibility: hidden;
    border-radius: 16px;
    display: flex; flex-direction: column;
    justify-content: space-between;
    padding: 14px 18px;
    box-sizing: border-box;
  }

  /* Neu: Front ist um 180° gedreht, damit flipped dauerhaft Vorderseite zeigt */
  .front {
    transform: rotateY(180deg);
  }
  .back {
    font-family: 'Press Start 2P', cursive;
    font-size: 28px;
    display: flex; justify-content: center; align-items: center;
  }

  .index-top-left, .index-bottom-right {
    font-weight: bold; font-size: 20px; user-select:none;
  }
  .index-bottom-right { transform: rotate(180deg); align-self: flex-end; }
  .center-symbol {
    flex-grow: 1; display: flex; justify-content: center; align-items: center;
    font-size: 72px; opacity: 0.85; user-select:none;
  }
  #restartBtn {
    border: none;
    border-radius: 14px; padding: 14px 28px; font-size: 18px;
    margin-top: 20px; cursor: pointer;
    letter-spacing: 2px;
    transition: opacity 0.3s ease;
  }

  /* Vorderseiten – sanftere Farben */
  .design-0 .front { background: #fce4e4; color: #8b2c2c; box-shadow: 0 4px 12px rgba(200,150,150,0.5); }
  .design-1 .front {
    background: #ffffff; border: 4px solid #c05050; color: #c05050;
    font-family: 'Comic Neue', cursive;
  }
  .design-2 .front {
    background: #fff3b0; color: #3a3a3a;
    font-family: 'Press Start 2P', cursive; border: 3px dashed #3a3a3a;
  }
  .design-3 .front {
    background: linear-gradient(135deg, #e8f4fa, #b5d4e5);
    color: #00334d; font-family: 'Roboto Slab', serif;
  }

  /* Rückseiten – sanfter angepasst */
  .back.design-0 { background: #444; color: #fce4e4; }
  .back.design-1 { background: #c05050; color: #fff; }
  .back.design-2 { background: #3a3a3a; color: #fff3b0; }
  .back.design-3 { background: #00334d; color: #b5d4e5; }

  /* Restart-Button Styles */
  #restartBtn.design-0 { background: #8b2c2c; color: #fff; font-family: 'Press Start 2P', cursive; }
  #restartBtn.design-1 { background: #c05050; color: #fff; font-family: 'Comic Neue', cursive; }
  #restartBtn.design-2 { background: #fff3b0; color: #3a3a3a; font-family: 'Press Start 2P', cursive; }
  #restartBtn.design-3 { background: #00334d; color: #fff; font-family: 'Roboto Slab', serif; }

  #restartBtn:hover { opacity: 0.85; }
</style>
</head>
<body class="design-0">
  <div class="background-layer design-0-bg" id="backgroundLayer"></div>
  <div id="game">
    <div class="card" id="card">
      <div class="inner-card" id="innerCard">
        <div class="face front design-0" id="cardFront">
          <div class="index-top-left" id="indexTop"></div>
          <div class="center-symbol" id="centerSymbol"></div>
          <div class="index-bottom-right" id="indexBottom"></div>
        </div>
        <div class="face back design-0">Tutto</div>
      </div>
    </div>
    <button id="restartBtn" class="design-0">Reroll</button>
  </div>

<script>
  const cardPool = [
    {text: "Bonus 200", symbol: "🎲", count: 4},
    {text: "Bonus 300", symbol: "🎲", count: 4},
    {text: "Bonus 400", symbol: "🎲", count: 4},
    {text: "Bonus 500", symbol: "🎲", count: 4},
    {text: "Bonus 600", symbol: "🎲", count: 4},
    {text: "x2", symbol: "✖️", count: 5},
    {text: "Stop", symbol: "⛔", count: 10},
    {text: "Feuerwerk", symbol: "🎆", count: 5},
    {text: "Straße 2000", symbol: "➡️", count: 5},
    {text: "Plus/Minus 1000", symbol: "➕➖", count: 5},
    {text: "Kleeblatt", symbol: "☘️", count: 1}
  ];

  let deck = [];
  let currentDesign = 0;
  let flipped = false;

  function buildDeck() {
    deck = [];
    cardPool.forEach(c => {
      for (let i = 0; i < c.count; i++) {
        deck.push({text: c.text, symbol: c.symbol});
      }
    });
    // Bessere Durchmischung (Fisher–Yates)
    for (let i = deck.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [deck[i], deck[j]] = [deck[j], deck[i]];
    }
  }

  function drawCard() {
    if (deck.length === 0) buildDeck();
    const card = deck.pop();
    document.getElementById('indexTop').textContent = card.text;
    document.getElementById('indexBottom').textContent = card.text;
    document.getElementById('centerSymbol').textContent = card.symbol;
  }

  function flipCard() {
    const innerCard = document.getElementById('innerCard');
    if (!flipped) {
      drawCard();
      innerCard.classList.add('flipped');
      flipped = true;
    } else {
      // Rückseite zeigen, dann neue Karte und wieder Vorderseite
      innerCard.classList.remove('flipped');
      flipped = false;
      setTimeout(() => {
        drawCard();
        innerCard.classList.add('flipped');
        flipped = true;
      }, 500); // längere Pause, damit Rückseite sichtbar bleibt
    }
  }

  function nextDesign() {
    currentDesign = (currentDesign + 1) % 4;
    document.body.className = 'design-' + currentDesign;

    const frontFace = document.getElementById('cardFront');
    frontFace.className = 'face front design-' + currentDesign;

    const backFace = document.querySelector('.back');
    backFace.className = 'face back design-' + currentDesign;

    const restartBtn = document.getElementById('restartBtn');
    restartBtn.className = 'design-' + currentDesign;

    const backgroundLayer = document.getElementById('backgroundLayer');
    backgroundLayer.className = 'background-layer design-' + currentDesign + '-bg';
  }

  function restartGame() {
    buildDeck();
    nextDesign();
    flipped = false;
    document.getElementById('innerCard').classList.remove('flipped');
    setTimeout(() => {
      flipCard();
    }, 200);
  }

  document.getElementById('game').addEventListener('click', () => {
    flipCard();
  });

  document.getElementById('restartBtn').addEventListener('click', (e) => {
    e.stopPropagation();
    restartGame();
  });

  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('sw.js');
  }

  restartGame();
</script>
</body>
</html>